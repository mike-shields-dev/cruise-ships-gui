<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Major+Mono+Display&family=Press+Start+2P&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="css/normalize.css">
  <link rel="stylesheet" href="css/style.css">
  <title>Cruise Ships</title>
</head>

<body>
  <header>
    <form>
      <label for="port">Add Port</label>
      <input type="text" name="port" placeholder="Port Name" required>
      <div id="form-buttons">
        <button id="add-port-button">Add</button>
        <button id="book-button" type="submit">Book</button>
      </div>
      <p>Itinerary</p>
      <div id="itinerary-list"></div>
    </form>

    <div id="journey-status">
      <p>Current Port: <span id="current-port"></span></p>
      <p>Next Port: <span id="next-port"></span></p>
    </div>

  </header>
  <div id="viewport" class="scrollbar-hidden">
    <div id="ports"></div>
    <div id="ship" class="shift">
      <div id="ship-inner" class="bob">

      </div>
    </div>
  </div>
  <div id="ui-container">
    <button id="sail-button">Set Sail!</button>
    <p id="message"></p>
  </div>

  <script src="./src/Controller.js"></script>
  <script src="/src/Port.js"></script>
  <script src="/src/Itinerary.js"></script>
  <script src="/src/Ship.js"></script>
  <script>
    let portNames = []
    let itinerary
    let ship
    let controller
    const form = document.querySelector('form')
    const addPortButton = document.querySelector('#add-port-button')
    const itineraryListEl = document.querySelector('#itinerary-list')

    addPortButton.addEventListener('click', (e) => {
      e.preventDefault()
      const portName = 
        form.port.value
          .toLowerCase()
          .split(" ").map(word => `${word[0].toUpperCase()}${word.slice(1)}`)
          .join(" ")
          .trim()

      if (!portName || portNames.includes(portName)) {
        alert('Port already exists')
        return 
      } else {
        portNames.push(portName)
      }

      itineraryListEl.innerHTML = ''
      portNames.forEach(portName => {
        const portNameEl = document.createElement('p')
        portNameEl.innerText = portName
        itineraryListEl.appendChild(portNameEl)
      })
    })


    form.addEventListener('submit', (e) => {
      e.preventDefault();
      if (portNames.length < 2) {
        alert('You must add at least two ports')
        return
      } 
      form.port.value = ""
      console.log({portNames});
      itinerary = new Itinerary(portNames.map(portName => new Port(portName)))
      ship = new Ship(itinerary)
      controller = new Controller(ship)

      controller.renderPorts(itinerary.ports)
      controller.positionShip(ship)
    })

  </script>
</body>

</html>